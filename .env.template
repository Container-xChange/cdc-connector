# =============================================================================
# CDC Pipeline Environment Variables Template
# =============================================================================
# Copy this file to .env and fill in your actual credentials
# This template is used by GitHub Actions and local development
# =============================================================================

# -----------------------------------------------------------------------------
# MariaDB Instance 1 - Trading
# -----------------------------------------------------------------------------
TRADING_HOST=
TRADING_PORT=3306
TRADING_DB=xchange_trading
TRADING_USER=
TRADING_PASS=
TRADING_SERVER_ID=
TRADING_TABLE_ALLOWLIST=xchange_trading.T_DEAL,xchange_trading.T_DEAL_DECLINE_REASON,xchange_trading.T_DEAL_HISTORY,xchange_trading.T_DEAL_PROPOSAL,xchange_trading.T_DECLINE_REASON,xchange_trading.T_ABSTRACT_OFFER,xchange_trading.T_ABSTRACT_OFFER_ATTACHMENT

# -----------------------------------------------------------------------------
# MariaDB Instance 2 - Finance
# -----------------------------------------------------------------------------
FINANCE_HOST=
FINANCE_PORT=3306
FINANCE_DB=xchange_finance
FINANCE_USER=
FINANCE_PASS=
FINANCE_SERVER_ID=
FINANCE_TABLE_ALLOWLIST=xchange_finance.T_ACCOUNT,xchange_finance.T_INVOICE,xchange_finance.T_MEMBERSHIP_CONTRACT,xchange_finance.T_MEMBERSHIP_CONTRACT_VERSION,xchange_finance.T_MEMBERSHIP_CONTRACT_VERSION_DISCOUNT,xchange_finance.T_MEMBERSHIP_CONTRACT_VERSION_PAUSE,xchange_finance.T_LINE_ITEM,xchange_finance.T_INVOICE_LINE_ITEM,xchange_finance.T_FINANCIAL_CONTACT

# -----------------------------------------------------------------------------
# MariaDB Instance 3 - Live
# -----------------------------------------------------------------------------
LIVE_HOST=
LIVE_PORT=3306
LIVE_DB=xchangelive
LIVE_USER=
LIVE_PASS=
LIVE_SERVER_ID=
LIVE_TABLE_ALLOWLIST=xchangelive.T_CARRIER,xchangelive.T_COMPANY_REVIEW,xchangelive.T_DEPOT_MAPPER,xchangelive.T_LOCATION,xchangelive.T_REQUEST,xchangelive.T_REQUEST_PAYMENT,xchangelive.T_REQUEST_VERSION,xchangelive.T_USER,xchangelive.T_PICKUP_DATA

# -----------------------------------------------------------------------------
# MariaDB Instance 4 - Chat
# -----------------------------------------------------------------------------
CHAT_HOST=
CHAT_PORT=3306
CHAT_DB=xchange_chat
CHAT_USER=
CHAT_PASS=
CHAT_SERVER_ID=
CHAT_TABLE_ALLOWLIST=xchange_chat.T_CHANNEL,xchange_chat.T_MESSAGE

# -----------------------------------------------------------------------------
# MariaDB Instance 5 - Performance
# -----------------------------------------------------------------------------
PERFORMANCE_HOST=
PERFORMANCE_PORT=3306
PERFORMANCE_USER=
PERFORMANCE_PASS=
PERFORMANCE_DB=xchange_company_performance
PERFORMANCE_SERVER_ID=
PERFORMANCE_TABLE_ALLOWLIST=xchange_company_performance.T_COMPANY_PERFORMANCE_METRICS,xchange_company_performance.T_COMPANY_PERFORMANCE_METRICS_HISTORY

# -----------------------------------------------------------------------------
# MariaDB Instance 6 - Concontrol
# -----------------------------------------------------------------------------
CONCONTROL_HOST=
CONCONTROL_PORT=3306
CONCONTROL_USER=
CONCONTROL_PASS=
CONCONTROL_DB=xchange_concontrol
CONCONTROL_SERVER_ID=
CONCONTROL_TABLE_ALLOWLIST=xchange_concontrol.T_CONTAINER,xchange_concontrol.T_DEPOT,xchange_concontrol.T_REFERENCE,xchange_concontrol.T_TRANSACTION

# -----------------------------------------------------------------------------
# MariaDB Instance 7 - Claim
# -----------------------------------------------------------------------------
CLAIM_HOST=
CLAIM_PORT=3306
CLAIM_USER=
CLAIM_PASS=
CLAIM_DB=xchange_claim
CLAIM_SERVER_ID=
CLAIM_TABLE_ALLOWLIST=xchange_claim.T_CLAIM,xchange_claim.T_CONTAINER

# -----------------------------------------------------------------------------
# MariaDB Instance 8 - Payment
# -----------------------------------------------------------------------------
PAYMENT_HOST=
PAYMENT_PORT=3306
PAYMENT_USER=
PAYMENT_PASS=
PAYMENT_DB=xchange_payment
PAYMENT_SERVER_ID=
PAYMENT_TABLE_ALLOWLIST=xchange_payment.T_RESOLVE_PAYMENT_DETAILS,xchange_payment.T_STRIPE_CUSTOMER

# -----------------------------------------------------------------------------
# PostgreSQL Target Database
# -----------------------------------------------------------------------------
# Used by migrate_v3.py for direct connection
PG_HOST=
PG_PORT=5432
PG_DB=raw_db
PG_USER=
PG_PASS=

# -----------------------------------------------------------------------------
# PostgreSQL Sink Configuration
# -----------------------------------------------------------------------------
# Used by Debezium sink connectors
SINK_DB_HOST=
SINK_DB_PORT=5432
SINK_DB_NAME=raw_db
SINK_DB_USER=
SINK_DB_PASSWORD=
# JDBC URL with SSL (adjust based on your setup)
SINK_DB_URL=jdbc:postgresql://YOUR_HOST:5432/raw_db?sslmode=require

# -----------------------------------------------------------------------------
# Kafka Configuration (AWS MSK or Confluent Cloud)
# -----------------------------------------------------------------------------
KAFKA_BOOTSTRAP_SERVERS=
KAFKA_SECURITY_PROTOCOL=SASL_SSL
KAFKA_SASL_MECHANISM=SCRAM-SHA-512
KAFKA_LOGIN_MODULE=scram.ScramLoginModule
CONFLUENT_API_KEY=
CONFLUENT_API_SECRET=

# -----------------------------------------------------------------------------
# Schema Registry Configuration (Optional)
# -----------------------------------------------------------------------------
SCHEMA_REGISTRY_URL=
SCHEMA_REGISTRY_API_KEY=
SCHEMA_REGISTRY_API_SECRET=
CREDENTIAL_SOURCE=USER_INFO

# -----------------------------------------------------------------------------
# Debezium Connect URL
# -----------------------------------------------------------------------------
# Production Debezium instance (hosted on Fly.io)
DEBEZIUM_URL=https://cdc-connector.fly.dev
# Development Debezium instance (optional)
DEV_DEBEZIUM_URL=https://cdc-dev-connector.fly.dev

# -----------------------------------------------------------------------------
# Kafka Internal Topics Configuration
# -----------------------------------------------------------------------------
CONFIG_STORAGE_TOPIC=debezium_configs
OFFSET_STORAGE_TOPIC=debezium_offsets
STATUS_STORAGE_TOPIC=debezium_statuses

CONFIG_STORAGE_REPLICATION_FACTOR=2
OFFSET_STORAGE_REPLICATION_FACTOR=2
STATUS_STORAGE_REPLICATION_FACTOR=2

# -----------------------------------------------------------------------------
# Monitoring & Alerts (Optional)
# -----------------------------------------------------------------------------
SLACK_BOT_TOKEN=
SLACK_CHANNEL_ID=

# =============================================================================
# ADDING A NEW DATABASE
# =============================================================================
# To add a new database to the CDC pipeline:
#
# 1. Add environment variables following the pattern above:
#    <DATABASE>_HOST=...
#    <DATABASE>_PORT=3306
#    <DATABASE>_DB=...
#    <DATABASE>_USER=...
#    <DATABASE>_PASS=...
#    <DATABASE>_SERVER_ID=...  (unique integer)
#    <DATABASE>_TABLE_ALLOWLIST=schema.table1,schema.table2
#
# 2. Create connector configs:
#    - connectors/sources/mariadb/<database>.json
#    - connectors/sinks/postgres/<database>.json
#
# 3. Add Makefile targets for the new database
#
# 4. Update migrate_v3.py if needed (for custom schema names)
#
# See README.md "Creating New Connectors" section for detailed instructions
# =============================================================================
